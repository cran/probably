<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Davis Vaughan" />

<meta name="date" content="2020-01-13" />

<title>Equivocal zones</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Equivocal zones</h1>
<h4 class="author">Davis Vaughan</h4>
<h4 class="date">2020-01-13</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(probably)</a></code></pre></div>
<div id="equivocal-zones" class="section level2">
<h2>Equivocal zones</h2>
<p>In some fields, class probability predictions must meet certain standards before a firm decision can be made using them. If they fail these standards, the prediction can be marked as <em>equivocal</em>, which just means that you are unsure of the true result. You might want to further investigate these equivocal values, or rerun whatever process generated them before proceeding.</p>
<p>For example, in a binary model, if a prediction returned probability values of 52% Yes and 48% No, are you really sure that that isn’t just random noise? In this case, you could use a <em>buffer</em> surrounding a <em>threshold</em> of 50% to determine whether or not your model is sure of its predictions, and mark values you are unsure about as equivocal.</p>
<p>Another example could come from a Bayesian perspective, where each prediction comes with a probability distribution. Your model might predict 80% Yes, but could have a standard deviation around that of +/- 20%. In this case, you could set a maximum allowed standard deviation as the cutoff of whether or not to mark values as equivocal.</p>
<p>To work with these equivocal zones, probably provides a new class for hard class predictions that is very similar to a factor, but allows you to mark certain values as equivocal.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># Create a class_pred object from a factor</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">class_pred</span>(x)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; [1] Yes No  Yes Yes</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; Levels: No Yes</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; Reportable: 100%</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co"># Say you aren't sure about that 2nd &quot;Yes&quot; value. </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co"># You could mark it as equivocal.</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="kw">class_pred</span>(x, <span class="dt">which =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; [1] Yes  No   [EQ] Yes </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; Levels: No Yes</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; Reportable: 75%</span></a></code></pre></div>
<p>The <em>reportable rate</em> is the fraction of values that are not equivocal, relative to the total number. Above, you can see that the reportable rate started at 100%, but as soon as a single value was marked equivocal, that value dropped to 75%. In fields where equivocal zones are used, there is often a tradeoff between marking values as equivocal and keeping a certain minimum reportable rate.</p>
<p>Generally, you won’t create these <code>class_pred</code> objects directly, but will instead create them indirectly through converting class probabilities into class predictions with <code>make_class_pred()</code> and <code>make_two_class_pred()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">data</span>(<span class="st">&quot;segment_logistic&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">segment_logistic</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; # A tibble: 1,010 x 3</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;    .pred_poor .pred_good Class</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;  *      &lt;dbl&gt;      &lt;dbl&gt; &lt;fct&gt;</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;  1    0.986      0.0142  poor </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;  2    0.897      0.103   poor </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;  3    0.118      0.882   good </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;  4    0.102      0.898   good </span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt;  5    0.991      0.00914 poor </span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;  6    0.633      0.367   good </span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  7    0.770      0.230   good </span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;  8    0.00842    0.992   good </span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;  9    0.995      0.00458 poor </span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; 10    0.765      0.235   poor </span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; # … with 1,000 more rows</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co"># Convert probabilities into predictions</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co"># &gt; 0.5 = good</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co"># &lt; 0.5 = poor</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22">segment_logistic_thresh &lt;-<span class="st"> </span>segment_logistic <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">    <span class="dt">.pred =</span> <span class="kw">make_two_class_pred</span>(</a>
<a class="sourceLine" id="cb3-25" data-line-number="25">      <span class="dt">estimate =</span> .pred_good, </a>
<a class="sourceLine" id="cb3-26" data-line-number="26">      <span class="dt">levels =</span> <span class="kw">levels</span>(Class), </a>
<a class="sourceLine" id="cb3-27" data-line-number="27">      <span class="dt">threshold =</span> <span class="fl">0.5</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28">    )</a>
<a class="sourceLine" id="cb3-29" data-line-number="29">  )</a>
<a class="sourceLine" id="cb3-30" data-line-number="30"></a>
<a class="sourceLine" id="cb3-31" data-line-number="31">segment_logistic_thresh</a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; # A tibble: 1,010 x 4</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt;    .pred_poor .pred_good Class      .pred</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt;         &lt;dbl&gt;      &lt;dbl&gt; &lt;fct&gt; &lt;clss_prd&gt;</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt;  1    0.986      0.0142  poor        poor</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt;  2    0.897      0.103   poor        poor</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt;  3    0.118      0.882   good        good</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">#&gt;  4    0.102      0.898   good        good</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#&gt;  5    0.991      0.00914 poor        poor</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co">#&gt;  6    0.633      0.367   good        poor</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co">#&gt;  7    0.770      0.230   good        poor</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="co">#&gt;  8    0.00842    0.992   good        good</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">#&gt;  9    0.995      0.00458 poor        poor</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="co">#&gt; 10    0.765      0.235   poor        poor</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="co">#&gt; # … with 1,000 more rows</span></a></code></pre></div>
<p>If a <code>buffer</code> is used, an equivocal zone is created around the threshold of <code>threshold +/- buffer</code> and any values inside the zone are automatically marked as equivocal.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Convert probabilities into predictions</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#        x &gt; 0.55 = good</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#        x &lt; 0.45 = poor</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># 0.45 &lt; x &lt; 0.55 = equivocal</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">segment_pred &lt;-<span class="st"> </span>segment_logistic <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">    <span class="dt">.pred =</span> <span class="kw">make_two_class_pred</span>(</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">      <span class="dt">estimate =</span> .pred_good, </a>
<a class="sourceLine" id="cb4-9" data-line-number="9">      <span class="dt">levels =</span> <span class="kw">levels</span>(Class), </a>
<a class="sourceLine" id="cb4-10" data-line-number="10">      <span class="dt">threshold =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">      <span class="dt">buffer =</span> <span class="fl">0.05</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">    )</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  ) </a>
<a class="sourceLine" id="cb4-14" data-line-number="14"></a>
<a class="sourceLine" id="cb4-15" data-line-number="15">segment_pred <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="st">  </span><span class="kw">count</span>(.pred)</a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;        .pred     n</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;   &lt;clss_prd&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt; 1       [EQ]    45</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; 2       good   340</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; 3       poor   625</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"></a>
<a class="sourceLine" id="cb4-24" data-line-number="24">segment_pred <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">reportable =</span> <span class="kw">reportable_rate</span>(.pred))</a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; # A tibble: 1 x 1</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt;   reportable</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt;        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; 1      0.955</span></a></code></pre></div>
<p>Equivocal values in <code>class_pred</code> objects are converted to <code>NA</code> when the object is converted to a factor. It’s also worth noting that the <code>[EQ]</code> label is not treated as a separate level.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">segment_pred <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.pred_fct =</span> <span class="kw">as.factor</span>(.pred)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>(.pred, .pred_fct)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; Warning: Factor `.pred_fct` contains implicit NA, consider using</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; `forcats::fct_explicit_na`</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt;        .pred .pred_fct     n</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt;   &lt;clss_prd&gt; &lt;fct&gt;     &lt;int&gt;</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; 1       [EQ] &lt;NA&gt;         45</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; 2       good good        340</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; 3       poor poor        625</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw">levels</span>(segment_pred<span class="op">$</span>.pred)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; [1] &quot;good&quot; &quot;poor&quot;</span></a></code></pre></div>
<p>This <code>NA</code> behavior feeds into how probably can be used with yardstick. Generally, equivocal values are removed completely from performance evaluation. So converting them to <code>NA</code> and then leaving the default <code>na_rm = TRUE</code> in any yardstick metric removes them from consideration.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">library</span>(yardstick)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; For binary classification, the first factor level is assumed to be the event.</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; Set the global option `yardstick.event_first` to `FALSE` to change this.</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co"># No equivocal zone</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">segment_logistic_thresh <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.pred_fct =</span> <span class="kw">as.factor</span>(.pred)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="st">  </span><span class="kw">precision</span>(Class, .pred_fct)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;   .metric   .estimator .estimate</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; 1 precision binary         0.680</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co"># Equivocal zone</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15">segment_pred <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">.pred_fct =</span> <span class="kw">as.factor</span>(.pred)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="st">  </span><span class="kw">precision</span>(Class, .pred_fct)</a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt;   .metric   .estimator .estimate</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; 1 precision binary         0.694</span></a></code></pre></div>
<p>As seen above, removing equivocal values using a simple threshold generally improves performance because the values your model is most unsure about are removed. But don’t be fooled! You should give those cases extra consideration, and remember that your reportable rate has decreased by removing them. In production, you’ll likely have to do something with those predictions!</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
